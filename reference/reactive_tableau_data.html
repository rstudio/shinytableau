<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Construct a reactive expression that reads Tableau data — reactive_tableau_data • shinytableau</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Construct a reactive expression that reads Tableau data — reactive_tableau_data" />
<meta property="og:description" content="This function is used to read data from Tableau. Because of the many levels
of indirection involved in actually physically reading data from Tableau,
using this function is significantly more involved than, say, a simple
read.csv(). See the Details section for a more detailed introduction." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->




  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">shinytableau</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Development version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorial
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/shinytableau.html">Introduction to shinytableau</a>
    </li>
    <li>
      <a href="../articles/helloworld.html">Writing your first extension</a>
    </li>
    <li>
      <a href="../articles/config.html">Adding configuration settings</a>
    </li>
    <li>
      <a href="../articles/data.html">Accessing data from Tableau</a>
    </li>
    <li>
      <a href="../articles/example.html">Full ggviolin example</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/ui.html">UI considerations</a>
    </li>
    <li>
      <a href="../articles/deployment.html">Deployment</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/rstudio/shinytableau">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Construct a reactive expression that reads Tableau data</h1>
    
    <div class="hidden name"><code>reactive_tableau_data.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function is used to read data from Tableau. Because of the many levels
of indirection involved in actually physically reading data from Tableau,
using this function is significantly more involved than, say, a simple
<code><a href='https://rdrr.io/r/utils/read.table.html'>read.csv()</a></code>. See the Details section for a more detailed introduction.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>reactive_tableau_data</span><span class='op'>(</span>
  <span class='va'>spec</span>,
  options <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  session <span class='op'>=</span> <span class='fu'>shiny</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/shiny/man/domains.html'>getDefaultReactiveDomain</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>spec</th>
      <td><p>An argument that specifies what specific data should be
accessed. This can be specified in a number of ways:</p><ol>
<li><p>The name of a setting, that was set using a value returned from
<code><a href='choose_data.html'>choose_data()</a></code>. This is the most common scenario for <code>server</code>.</p></li>
<li><p>The object returned from <code><a href='choose_data.html'>choose_data()</a></code> can be passed in directly. This
is likely the approach you should take if you want to access data in
<code>config_server</code> based on unsaved config changes (e.g. to give the user a
live preview of what their <code>choose_data</code> choices would yield).</p></li>
<li><p>You can directly create a spec object using one of the helper functions
<code><a href='spec_summary.html'>spec_summary()</a></code>, <code><a href='spec_summary.html'>spec_underlying()</a></code>, or <code><a href='spec_summary.html'>spec_datasource()</a></code>. For cases where
the data is not selected based on <code><a href='choose_data.html'>choose_data()</a></code> at all, but
programmatically determined or hardcoded. (This should not be common.)</p></li>
</ol></td>
    </tr>
    <tr>
      <th>options</th>
      <td><p>A named list of options:</p><ul>
<li><p><code>ignoreAliases</code> - Do not use aliases specified in the data source in
Tableau. Default is <code>FALSE</code>.</p></li>
<li><p><code>ignoreSelection</code> - If <code>FALSE</code> (the default), only return data for the
currently selected marks. Does not apply for datasource tables, only
summary and underlying.</p></li>
<li><p><code>includeAllColumns</code> - Return all the columns for the table. Default is
<code>FALSE</code>. Does not apply for datasource and summary tables, only underlying.</p></li>
<li><p><code>maxRows</code> - The maximum number of rows to return. <strong>Tableau will not,
under any circumstances, return more than 10,000 rows for datasource and
underlying tables.</strong> This option is ignored for summary tables.</p></li>
<li><p><code>columnsToInclude</code> - Character vector of columns that should be included;
leaving this option unspecified means all columns should be returned. Does
not apply for summary and underlying, only datasource.</p></li>
<li><p><code>truncation</code> - For underlying and datasource reads, Tableau will never,
under any circumstances, return more than 10,000 rows of data. If <code>warn</code>
(the default), when this condition occurs a warning will be displayed to
the user and emitted as a warning in the R process, then the available
data will be returned. If <code>ignore</code>, then no warning will be issued. If
<code>error</code>, then an error will be raised.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>session</th>
      <td><p>The Shiny <code>session</code> object. (You should probably just use the
default.)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>There are two complicating factors when reading data from Tableau; the first
is how to tell shinytableau what specific data table you want to access, and
the second is actually accessing the data from R.</p><h3 class='hasAnchor' id='specifying-a-data-table'><a class='anchor' aria-hidden='true' href='#specifying-a-data-table'></a>Specifying a data table</h3>


<p>If we want to access data from Tableau, the Tableau Extension API only allows
us to do so via one of the worksheets that are part of the same dashboard.</p>
<p>Each worksheet makes three categories of data available to us:</p><ol>
<li><p><strong>Summary data:</strong> The data in its final form before visualization. If the
visualization aggregates measures, then the summary data contains the data
after aggregation has been performed. If the worksheet has an active
selection, then by default, only the selected data is returned (set the
<code>ignoreSelection</code> option to <code>TRUE</code> to retrieve all data).</p></li>
<li><p><strong>Underlying data:</strong> The underlying data that is used in the visualization,
before aggregation operations are performed but after tables are joined.</p>
<p>By default, only the columns that are used in the worksheet are included
(set <code>includeAllColumns</code> to <code>TRUE</code> if you need them all). If the worksheet
has an active selection, then by default, only the selected data is
returned (set the <code>ignoreSelection</code> option to <code>TRUE</code> to retrieve all
data).</p></li>
<li><p><strong>Data source:</strong> You can also access the raw data from the data source(s)
used by the worksheet. This data is unaffected by the worksheet settings.
Tableau data sources are broken into one or more logical tables, like how
a relational database has multiple tables.</p></li>
</ol>

<p>As an R user, you may find this analogy based on the examples from
<a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>dplyr::mutate-joins</a> to be helpful in explaining the relationship between
data source, underlying, and summary data:</p><pre class='sourceCode r'><code><span class='co'># Data source</span>
<span class='va'>logical1</span> <span class='op'>&lt;-</span> <span class='va'>band_members</span>
<span class='va'>logical2</span> <span class='op'>&lt;-</span> <span class='va'>band_instruments</span>

<span class='co'># Underlying is joined/selected, but not aggregated</span>
<span class='va'>underlying</span> <span class='op'>&lt;-</span> <span class='va'>band_members</span> <span class='op'>%&gt;%</span>
  <span class='fu'>full_join</span><span class='op'>(</span><span class='va'>band_instruments</span>, by <span class='op'>=</span> <span class='st'>"name"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>band</span>, <span class='va'>name</span><span class='op'>)</span>

<span class='co'># Summary is underlying plus aggregation</span>
<span class='va'>summary</span> <span class='op'>&lt;-</span> <span class='va'>underlying</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>band</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>tally</span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"COUNT(name)"</span><span class='op'>)</span>
</code></pre>

<p>The existence of these three levels of data granularity, plus the fact that
the underlying and data source levels need additional specification to narrow
down which of the multiple data tables at each level are desired, means that
providing clear instructions to <code>reactive_tableau_data</code> is surprisingly
complicated.</p>
<p>Now that you have some context, see the description for the <code>spec</code> parameter,
above, for specific instructions on the different ways to specify data
tables, based on current user input, previously saved configuration, or
programmatically.</p>

<h3 class='hasAnchor' id='accessing-a-data-table'><a class='anchor' aria-hidden='true' href='#accessing-a-data-table'></a>Accessing a data table</h3>


<p>We turn our attention now to consuming data from <code>reactive_tableau_data()</code>.
Given the following code snippet, one that might appear in <code>config_server</code>:</p><pre class='sourceCode r'><code><span class='va'>data_spec</span> <span class='op'>&lt;-</span> <span class='fu'><a href='choose_data.html'>choose_data</a></span><span class='op'>(</span><span class='st'>"mydata"</span><span class='op'>)</span>
<span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'>reactive_tableau_data</span><span class='op'>(</span><span class='va'>data_spec</span><span class='op'>)</span>
</code></pre>

<p>The <code>data</code> variable created here has two complications.</p>
<p>First, it's reactive; like all reactive expressions, you must call <code>data</code> as
a function to get at its value. It must be reactive because Tableau data can
change (based on selection and filtering, if nothing else), and also, the
user's choices can change as well (in the example, the <code>data_spec</code> object is
also reactive).</p>
<p>Second, and more seriously, reading Tableau data is asynchronous, so when you
invoke <code><a href='https://rdrr.io/r/utils/data.html'>data()</a></code> what you get back is not a data frame, but the <a href='https://rstudio.github.io/promises/articles/overview.html'>promise of a data frame</a>.
Working with promises has its own learning curve, so it's regrettable that
they play such a prominent role in reading Tableau data. If this is a new
topic for you, <a href='https://rstudio.com/resources/rstudioconf-2018/scaling-shiny-apps-with-async-programming/'>start with this talk</a>
and then read through the various articles on the <a href='https://rstudio.github.io/promises/'>promises website</a>.</p>
<p>The bottom line with promises is that you can use any of the normal functions
you usually use for manipulating, analyzing, and visualizing data frames, but
the manner in which you invoke those functions will be a bit different.
Instead of calling <code>print(data())</code>, for example, you'll need to first change
to the more pipe-oriented <code>data() %&gt;% print()</code> and then replace the magrittr
pipe with the promise-pipe like <code>data() %...&gt;% print()</code>. There's much more to
the story, though; for all but the simplest scenarios, you'll need to check
out the resources linked in the previous paragraph.</p>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'><span class='va'>data_spec_x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='choose_data.html'>choose_data</a></span><span class='op'>(</span><span class='st'>"x"</span>, iv <span class='op'>=</span> <span class='va'>iv</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>data_x</span> <span class='op'>&lt;-</span> <span class='fu'>reactive_tableau_data</span><span class='op'>(</span><span class='va'>data_spec_x</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>}</span></span>
<span class='r-in'></span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Joe Cheng, Richard Iannone, Javier Luraschi, RStudio.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


